# memU + N8N Integration ü§ñüß†

‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ memU ‡∏Å‡∏±‡∏ö N8N ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á No-Code AI Chatbot ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥

## ‡∏™‡∏ñ‡∏≤‡∏õ‡∏±‡∏ï‡∏¢‡∏Å‡∏£‡∏£‡∏° (Architecture)

```
LINE User
    ‚îÇ
    ‚ñº
LINE Platform (Webhook)
    ‚îÇ
    ‚ñº
N8N Workflow
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚ñ∫ POST /retrieve ‚îÄ‚îÄ‚ñ∫ memU API Server ‚îÄ‚îÄ‚ñ∫ OpenAI (Embeddings)
    ‚îÇ                              ‚îÇ
    ‚îÇ                              ‚ñº
    ‚îÇ                        ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚ñ∫ OpenAI Chat (‡πÉ‡∏ä‡πâ context ‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥)
    ‚îÇ
    ‚îú‚îÄ‚îÄ‚ñ∫ POST /memorize ‚îÄ‚îÄ‚ñ∫ memU API Server ‚îÄ‚îÄ‚ñ∫ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏ó‡∏ô‡∏≤
    ‚îÇ
    ‚îî‚îÄ‚îÄ‚ñ∫ LINE Reply ‚îÄ‚îÄ‚ñ∫ ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
```

## ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô

- Python 3.10+
- [N8N](https://n8n.io/) (self-hosted ‡∏´‡∏£‡∏∑‡∏≠ cloud)
- LINE Messaging API account
- OpenAI API key

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### 1. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á memU ‡πÅ‡∏•‡∏∞ dependencies

```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á memU ‡∏à‡∏≤‡∏Å root ‡∏Ç‡∏≠‡∏á repository
pip install -e ".[all]"

# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö API server
cd examples/n8n
pip install -r requirements.txt
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables

```bash
# ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
cp .env.example .env

# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç .env
nano .env
```

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô `.env`:

```env
OPENAI_API_KEY=sk-your-openai-api-key
# DATABASE_URL=postgresql://user:pass@localhost:5432/memu  # ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö
API_HOST=0.0.0.0
API_PORT=8001
```

### 3. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô API Server

```bash
cd examples/n8n
uvicorn memu_api_server:app --host 0.0.0.0 --port 8001 --reload
```

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ:

```bash
curl http://localhost:8001/health
# {"status":"ok","service":"memU API"}
```

## API Endpoints

| Method | Endpoint | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|--------|----------|----------|
| `GET` | `/health` | ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå |
| `POST` | `/memorize` | ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ |
| `POST` | `/retrieve` | ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ |
| `GET` | `/categories/{user_id}` | ‡∏î‡∏π‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ |
| `DELETE` | `/memory/{user_id}` | ‡∏•‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î |

‡∏î‡∏π API documentation ‡πÅ‡∏ö‡∏ö interactive ‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà: `http://localhost:8001/docs`

## ‡∏Å‡∏≤‡∏£ Import Workflow ‡πÉ‡∏ô N8N

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Import ‡∏ú‡πà‡∏≤‡∏ô UI

1. ‡πÄ‡∏õ‡∏¥‡∏î N8N Dashboard
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **Workflows** ‚Üí **Add Workflow**
3. ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏°‡∏ô‡∏π (‚ãÆ) ‚Üí **Import from file**
4. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå JSON ‡∏à‡∏≤‡∏Å‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `workflows/`

### ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Import ‡∏ú‡πà‡∏≤‡∏ô URL

1. ‡πÉ‡∏ô N8N ‡∏Ñ‡∏•‡∏¥‡∏Å **Workflows** ‚Üí **Add Workflow**
2. ‡∏Ñ‡∏•‡∏¥‡∏Å **Import from URL**
3. ‡∏ß‡∏≤‡∏á URL ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå JSON

### Workflow ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏´‡πâ

| ‡πÑ‡∏ü‡∏•‡πå | ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢ |
|------|----------|
| `workflows/line_memu_bot.json` | LINE Chatbot ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥ |
| `workflows/memory_dashboard.json` | ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏£‡∏á‡∏à‡∏≥‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏™‡πà‡∏á LINE |

## ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Credentials ‡πÉ‡∏ô N8N

### LINE Messaging API

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Settings** ‚Üí **Credentials** ‚Üí **Add Credential**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **LINE** ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ HTTP Request node ‡∏û‡∏£‡πâ‡∏≠‡∏° header `Authorization: Bearer {TOKEN}`
3. ‡πÉ‡∏™‡πà **Channel Access Token** ‡∏à‡∏≤‡∏Å [LINE Developers Console](https://developers.line.biz/)

### OpenAI API

1. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà **Settings** ‚Üí **Credentials** ‚Üí **Add Credential**
2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å **OpenAI**
3. ‡πÉ‡∏™‡πà API Key ‡∏à‡∏≤‡∏Å [OpenAI Platform](https://platform.openai.com/)

### ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LINE Webhook URL

1. ‡πÉ‡∏ô N8N ‡πÄ‡∏õ‡∏¥‡∏î workflow **LINE memU Bot**
2. ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà node **LINE Webhook** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π Webhook URL
3. ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers Console](https://developers.line.biz/)
4. ‡∏ï‡∏±‡πâ‡∏á **Webhook URL** ‡πÄ‡∏õ‡πá‡∏ô URL ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å N8N
5. ‡πÄ‡∏õ‡∏¥‡∏î **Use webhook**

## Use Cases (‡∏Å‡∏£‡∏ì‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)

### 1. ü§ù Customer Memory Bot (‡∏ö‡∏≠‡∏ó‡∏à‡∏≥‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)
‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ memU ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤
‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏ó‡∏ï‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö personalized ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡∏Å‡∏°‡∏≤

### 2. üìù To-Do Reminder (‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥)
‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏≠‡∏Å‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏ú‡πà‡∏≤‡∏ô LINE ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏ó‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏£‡∏∏‡∏õ‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏î‡πâ

### 3. üè™ Mini CRM for Shops (CRM ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤)
‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡πâ‡∏≤‡∏ô‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ ‡∏¢‡∏≠‡∏î‡∏ã‡∏∑‡πâ‡∏≠ ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏≠‡∏ö
‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏î‡∏π‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô LINE ‡∏ó‡∏∏‡∏Å‡πÄ‡∏ä‡πâ‡∏≤‡πÄ‡∏ß‡∏•‡∏≤ 08:00

## ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

### API Server ‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö OPENAI_API_KEY
echo $OPENAI_API_KEY

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ port 8001 ‡∏ß‡πà‡∏≤‡∏á
lsof -i :8001
```

### N8N ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö API Server
- ‡∏´‡∏≤‡∏Å N8N ‡∏£‡∏±‡∏ô‡πÉ‡∏ô Docker ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ `host.docker.internal` ‡πÅ‡∏ó‡∏ô `localhost`
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö firewall settings

### LINE Webhook ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
- ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Webhook URL ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞ HTTPS
- ‡∏î‡∏π‡πÉ‡∏ô N8N **Executions** ‡πÄ‡∏û‡∏∑‡πà‡∏≠ debug
